<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Convert OpenOffice.org Calc FODS XML to something meaningful | Also sprach tealeg...</title>
<meta name="keywords" content="xslt, open_office, libre_office, fods, xml, spreadsheet, excel">
<meta name="description" content="Get the code: The code in this blog post is now available at:
http://github.com/tealeg/FODS2XML
Background For a while now I&rsquo;ve been receiving data in Excel files that needed to be integrated into some better structured XML data. Originally I was using a little xls2csv from the catdoc package in Arch Linux to pull the data from the horrible bloated XLS files into something usable.
The trouble is the conversion to CSV was a little error prone and it&rsquo;s really hard to see such errors in a 40MB CSV file.">
<meta name="author" content="Geoffrey J. Teale">
<link rel="canonical" href="https://www.teale.de/post/tech/programming/convert-openoffice-fods-xml/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css" integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://www.teale.de/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.teale.de/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.teale.de/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://www.teale.de/apple-touch-icon.png">
<link rel="mask-icon" href="https://www.teale.de/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Convert OpenOffice.org Calc FODS XML to something meaningful" />
<meta property="og:description" content="Get the code: The code in this blog post is now available at:
http://github.com/tealeg/FODS2XML
Background For a while now I&rsquo;ve been receiving data in Excel files that needed to be integrated into some better structured XML data. Originally I was using a little xls2csv from the catdoc package in Arch Linux to pull the data from the horrible bloated XLS files into something usable.
The trouble is the conversion to CSV was a little error prone and it&rsquo;s really hard to see such errors in a 40MB CSV file." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.teale.de/post/tech/programming/convert-openoffice-fods-xml/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2010-08-19T04:53:00&#43;02:00" />
<meta property="article:modified_time" content="2010-08-19T04:53:00&#43;02:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Convert OpenOffice.org Calc FODS XML to something meaningful"/>
<meta name="twitter:description" content="Get the code: The code in this blog post is now available at:
http://github.com/tealeg/FODS2XML
Background For a while now I&rsquo;ve been receiving data in Excel files that needed to be integrated into some better structured XML data. Originally I was using a little xls2csv from the catdoc package in Arch Linux to pull the data from the horrible bloated XLS files into something usable.
The trouble is the conversion to CSV was a little error prone and it&rsquo;s really hard to see such errors in a 40MB CSV file."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://www.teale.de/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Convert OpenOffice.org Calc FODS XML to something meaningful",
      "item": "https://www.teale.de/post/tech/programming/convert-openoffice-fods-xml/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Convert OpenOffice.org Calc FODS XML to something meaningful",
  "name": "Convert OpenOffice.org Calc FODS XML to something meaningful",
  "description": "Get the code: The code in this blog post is now available at:\nhttp://github.com/tealeg/FODS2XML\nBackground For a while now I\u0026rsquo;ve been receiving data in Excel files that needed to be integrated into some better structured XML data. Originally I was using a little xls2csv from the catdoc package in Arch Linux to pull the data from the horrible bloated XLS files into something usable.\nThe trouble is the conversion to CSV was a little error prone and it\u0026rsquo;s really hard to see such errors in a 40MB CSV file.",
  "keywords": [
    "xslt", "open_office", "libre_office", "fods", "xml", "spreadsheet", "excel"
  ],
  "articleBody": "Get the code: The code in this blog post is now available at:\nhttp://github.com/tealeg/FODS2XML\nBackground For a while now I’ve been receiving data in Excel files that needed to be integrated into some better structured XML data. Originally I was using a little xls2csv from the catdoc package in Arch Linux to pull the data from the horrible bloated XLS files into something usable.\nThe trouble is the conversion to CSV was a little error prone and it’s really hard to see such errors in a 40MB CSV file. What I really needed was something a bit more structured to work with. I decided I would try processing the data directly from an XML version of the spreadsheet. In OpenOffice.org 3 I have a few XML options (Microsoft XLSX, Open Document Format, and FODS) - I wasn’t aware of FODS XML before so I took a look. What FODS seems to be is a single file equivalent of the XML content that usually spans multiple files in the Zipped up folder that is an Open Document Format file. (I may be wrong - but this is my naive view of what I saw).\nConverting FODS with XSLT With the handy FODS verison of the spreadsheet I set about writing a two stage XSLT conversion that strips out the data and results in a meaningful XML file. This is all quick and dirty XSLT 2.0 - I’ve only tested in Saxon 9.2.0.6 and I wouldn’t put it forwards as an exemplary piece of XSLT 2.0, but I figured someone might find is useful.\nMy code assumes the following:\nThe data is arranged in tabular format There is only one table per tab in the sheet There is no extraneous data around the tab The first row contains column titles that are also valid XML element names (i.e. no spaces or other restricted characters). Stage 1 simplified the FODS data too a simple tabular XML format. The trickiest thing here is the expansion of repeated columns. Note as well, this XSLT 2.0 takes a parameter “collimit” that tells it to ignore columns that fall after that number - this makes the XSLT run a lot faster. fods2tbl.xsl looks like this:\n\u003c?xml version=\"1.0\" encoding=\"iso-8859-1\"?\u003e ",
  "wordCount" : "691",
  "inLanguage": "en",
  "datePublished": "2010-08-19T04:53:00+02:00",
  "dateModified": "2010-08-19T04:53:00+02:00",
  "author":{
    "@type": "Person",
    "name": "Geoffrey J. Teale"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.teale.de/post/tech/programming/convert-openoffice-fods-xml/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Also sprach tealeg...",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.teale.de/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://www.teale.de/" accesskey="h" title="Also sprach tealeg... (Alt + H)">Also sprach tealeg...</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://www.teale.de/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://www.teale.de/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://www.teale.de/post/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://www.teale.de/reference/" title="Reference">
                    <span>Reference</span>
                </a>
            </li>
            <li>
                <a href="https://www.teale.de/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Convert OpenOffice.org Calc FODS XML to something meaningful
    </h1>
    <div class="post-meta"><span title='2010-08-19 04:53:00 +0200 CEST'>Thu Aug 19 2010</span>&nbsp;·&nbsp;Geoffrey J. Teale

</div>
  </header> 
  <div class="post-content"><h2 id="get-the-code">Get the code:<a hidden class="anchor" aria-hidden="true" href="#get-the-code">#</a></h2>
<p>The code in this blog post is now available at:</p>
<p><a href="http://github.com/tealeg/FODS2XML">http://github.com/tealeg/FODS2XML</a></p>
<h2 id="background">Background<a hidden class="anchor" aria-hidden="true" href="#background">#</a></h2>
<p>For a while now I&rsquo;ve been receiving data in Excel files that needed to be integrated into some better structured XML data. Originally I was using a little xls2csv from the catdoc package in Arch Linux to pull the data from the horrible bloated XLS files into something usable.</p>
<p>The trouble is the conversion to CSV was a little error prone and it&rsquo;s really hard to see such errors in a 40MB CSV file. What I really needed was something a bit more structured to work with. I decided I would try processing the data directly from an XML version of the spreadsheet. In OpenOffice.org 3 I have a few XML options (Microsoft XLSX, Open Document Format, and FODS) - I wasn&rsquo;t aware of FODS XML before so I took a look. What FODS seems to be is a single file equivalent of the XML content that usually spans multiple files in the Zipped up folder that is an Open Document Format file. (I may be wrong - but this is my naive view of what I saw).</p>
<h2 id="converting-fods-with-xslt">Converting FODS with XSLT<a hidden class="anchor" aria-hidden="true" href="#converting-fods-with-xslt">#</a></h2>
<p>With the handy FODS verison of the spreadsheet I set about writing a two stage XSLT conversion that strips out the data and results in a meaningful XML file. This is all quick and dirty XSLT 2.0 - I&rsquo;ve only tested in Saxon 9.2.0.6 and I wouldn&rsquo;t put it forwards as an exemplary piece of XSLT 2.0, but I figured someone might find is useful.</p>
<p>My code assumes the following:</p>
<ul>
<li>The data is arranged in tabular format</li>
<li>There is only one table per tab in the sheet</li>
<li>There is no extraneous data around the tab</li>
<li>The first row contains column titles that are also valid XML element names (i.e. no spaces or other restricted characters).</li>
<li>Stage 1 simplified the FODS data too a simple tabular XML format. The trickiest thing here is the expansion of repeated columns. Note as well, this XSLT 2.0 takes a parameter &ldquo;collimit&rdquo; that tells it to ignore columns that fall after that number - this makes the XSLT run a lot faster.</li>
</ul>
<p><code>fods2tbl.xsl</code> looks like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xslt" data-lang="xslt"><span style="display:flex;"><span><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;iso-8859-1&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;xsl:stylesheet</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">version=</span><span style="color:#e6db74">&#34;2.0&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:xsl=</span><span style="color:#e6db74">&#34;http://www.w3.org/1999/XSL/Transform&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:office=</span><span style="color:#e6db74">&#34;urn:oasis:names:tc:opendocument:xmlns:office:1.0&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:style=</span><span style="color:#e6db74">&#34;urn:oasis:names:tc:opendocument:xmlns:style:1.0&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:text=</span><span style="color:#e6db74">&#34;urn:oasis:names:tc:opendocument:xmlns:text:1.0&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:table=</span><span style="color:#e6db74">&#34;urn:oasis:names:tc:opendocument:xmlns:table:1.0&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:draw=</span><span style="color:#e6db74">&#34;urn:oasis:names:tc:opendocument:xmlns:drawing:1.0&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:fo=</span><span style="color:#e6db74">&#34;urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:xlink=</span><span style="color:#e6db74">&#34;http://www.w3.org/1999/xlink&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:dc=</span><span style="color:#e6db74">&#34;http://purl.org/dc/elements/1.1/&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:meta=</span><span style="color:#e6db74">&#34;urn:oasis:names:tc:opendocument:xmlns:meta:1.0&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:number=</span><span style="color:#e6db74">&#34;urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:presentation=</span><span style="color:#e6db74">&#34;urn:oasis:names:tc:opendocument:xmlns:presentation:1.0&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:svg=</span><span style="color:#e6db74">&#34;urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:chart=</span><span style="color:#e6db74">&#34;urn:oasis:names:tc:opendocument:xmlns:chart:1.0&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:dr3d=</span><span style="color:#e6db74">&#34;urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:math=</span><span style="color:#e6db74">&#34;http://www.w3.org/1998/Math/MathML&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:form=</span><span style="color:#e6db74">&#34;urn:oasis:names:tc:opendocument:xmlns:form:1.0&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:script=</span><span style="color:#e6db74">&#34;urn:oasis:names:tc:opendocument:xmlns:script:1.0&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:config=</span><span style="color:#e6db74">&#34;urn:oasis:names:tc:opendocument:xmlns:config:1.0&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:ooo=</span><span style="color:#e6db74">&#34;http://openoffice.org/2004/office&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:ooow=</span><span style="color:#e6db74">&#34;http://openoffice.org/2004/writer&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:oooc=</span><span style="color:#e6db74">&#34;http://openoffice.org/2004/calc&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:dom=</span><span style="color:#e6db74">&#34;http://www.w3.org/2001/xml-events&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:xforms=</span><span style="color:#e6db74">&#34;http://www.w3.org/2002/xforms&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:xsd=</span><span style="color:#e6db74">&#34;http://www.w3.org/2001/XMLSchema&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:xsi=</span><span style="color:#e6db74">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:rpt=</span><span style="color:#e6db74">&#34;http://openoffice.org/2005/report&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:of=</span><span style="color:#e6db74">&#34;urn:oasis:names:tc:opendocument:xmlns:of:1.2&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:xhtml=</span><span style="color:#e6db74">&#34;http://www.w3.org/1999/xhtml&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:grddl=</span><span style="color:#e6db74">&#34;http://www.w3.org/2003/g/data-view#&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:tableooo=</span><span style="color:#e6db74">&#34;http://openoffice.org/2009/table&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:field=</span><span style="color:#e6db74">&#34;urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:formx=</span><span style="color:#e6db74">&#34;urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0&#34;</span>  
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:css3t=</span><span style="color:#e6db74">&#34;http://www.w3.org/TR/css3-text/&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:saxon=</span><span style="color:#e6db74">&#34;http://icl.com/saxon&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">extension-element-prefixes=</span><span style="color:#e6db74">&#34;saxon&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;xsl:output</span> <span style="color:#a6e22e">indent=</span><span style="color:#e6db74">&#34;yes&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">method=</span><span style="color:#e6db74">&#34;xml&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">encoding=</span><span style="color:#e6db74">&#34;UTF-8&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">saxon:character-representation=</span><span style="color:#e6db74">&#34;native;decimal&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;xsl:param</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;collimit&#34;</span> <span style="color:#a6e22e">select=</span><span style="color:#e6db74">&#34;100&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;xsl:template</span> <span style="color:#a6e22e">match=</span><span style="color:#e6db74">&#34;*&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">&lt;!-- Do Nothing --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/xsl:template&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;xsl:template</span> <span style="color:#a6e22e">match=</span><span style="color:#e6db74">&#34;office:document&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;document&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;xsl:apply-templates</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/document&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/xsl:template&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;xsl:template</span> <span style="color:#a6e22e">match=</span><span style="color:#e6db74">&#34;office:body&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;xsl:apply-templates/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/xsl:template&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;xsl:template</span> <span style="color:#a6e22e">match=</span><span style="color:#e6db74">&#34;office:spreadsheet&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;xsl:apply-templates/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/xsl:template&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;xsl:template</span> <span style="color:#a6e22e">match=</span><span style="color:#e6db74">&#34;table:table&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;table&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;xsl:attribute</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;xsl:value-of</span> <span style="color:#a6e22e">select=</span><span style="color:#e6db74">&#34;@table:name&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/xsl:attribute&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;xsl:apply-templates</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/table&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/xsl:template&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;xsl:template</span> <span style="color:#a6e22e">match=</span><span style="color:#e6db74">&#34;table:table-row&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;row&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;xsl:attribute</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;rownum&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;xsl:value-of</span> <span style="color:#a6e22e">select=</span><span style="color:#e6db74">&#34;count(preceding-sibling::table:table-row) + 1&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/xsl:attribute&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;xsl:apply-templates</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/row&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/xsl:template&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;xsl:template</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;repeat-cells&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;xsl:param</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;index&#34;</span> <span style="color:#a6e22e">select=</span><span style="color:#e6db74">&#34;0&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;xsl:param</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;cellnum&#34;</span> <span style="color:#a6e22e">select=</span><span style="color:#e6db74">&#34;1&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;xsl:if</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;$collimit &gt;= $cellnum&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;xsl:if</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;$index &gt; 0&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;cell&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;xsl:attribute</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;cellnum&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">&lt;xsl:value-of</span> <span style="color:#a6e22e">select=</span><span style="color:#e6db74">&#34;$cellnum&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;/xsl:attribute&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;/cell&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;xsl:call-template</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;repeat-cells&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;xsl:with-param</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;index&#34;</span> <span style="color:#a6e22e">select=</span><span style="color:#e6db74">&#34;$index - 1&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;xsl:with-param</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;cellnum&#34;</span> <span style="color:#a6e22e">select=</span><span style="color:#e6db74">&#34;$cellnum + 1&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;/xsl:call-template&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/xsl:if&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/xsl:if&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/xsl:template&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;xsl:template</span> <span style="color:#a6e22e">match=</span><span style="color:#e6db74">&#34;table:table-cell&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;xsl:variable</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;repeats&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">select=</span><span style="color:#e6db74">&#34;sum(preceding-sibling::table:table-cell/@table:number-columns-repeated) -
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     count(preceding-sibling::table:table-cell[@table:number-columns-repeated &gt; 0])&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;xsl:variable</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;cellnum&#34;</span> <span style="color:#a6e22e">select=</span><span style="color:#e6db74">&#34;count(preceding-sibling::table:table-cell) + $repeats + 1&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;xsl:if</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;$collimit &gt;= $cellnum&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;cell&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;xsl:attribute</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;cellnum&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;xsl:value-of</span> <span style="color:#a6e22e">select=</span><span style="color:#e6db74">&#34;$cellnum&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;/xsl:attribute&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;xsl:apply-templates</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/cell&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;xsl:if</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;@table:number-columns-repeated &gt; 0&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;xsl:call-template</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;repeat-cells&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;xsl:with-param</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;index&#34;</span> <span style="color:#a6e22e">select=</span><span style="color:#e6db74">&#34;@table:number-columns-repeated -1&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;xsl:with-param</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;cellnum&#34;</span> <span style="color:#a6e22e">select=</span><span style="color:#e6db74">&#34;$cellnum + 1&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;/xsl:call-template&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/xsl:if&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/xsl:if&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/xsl:template&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;xsl:template</span> <span style="color:#a6e22e">match=</span><span style="color:#e6db74">&#34;text:p&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;p&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;xsl:value-of</span> <span style="color:#a6e22e">select=</span><span style="color:#e6db74">&#34;.&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/p&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/xsl:template&gt;</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/xsl:stylesheet&gt;</span>
</span></span></code></pre></div><p>The second stage is to take the resulting tabular XML file and convert it to meaningful XML. The output essentially wraps each cell in a XML element with the name of the column it was taking from (extracted from the first row).</p>
<p><code>tbl2data.xsl</code> looks like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xslt" data-lang="xslt"><span style="display:flex;"><span><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;iso-8859-1&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;xsl:stylesheet</span> <span style="color:#a6e22e">version=</span><span style="color:#e6db74">&#34;2.0&#34;</span> <span style="color:#a6e22e">xmlns:xsl=</span><span style="color:#e6db74">&#34;http://www.w3.org/1999/XSL/Transform&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;xsl:output</span> <span style="color:#a6e22e">indent=</span><span style="color:#e6db74">&#34;yes&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">method=</span><span style="color:#e6db74">&#34;xml&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">encoding=</span><span style="color:#e6db74">&#34;UTF-8&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">xmlns:saxon=</span><span style="color:#e6db74">&#34;http://icl.com/saxon&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">saxon:character-representation=</span><span style="color:#e6db74">&#34;native;decimal&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;xsl:template</span> <span style="color:#a6e22e">match=</span><span style="color:#e6db74">&#34;*&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#75715e">&lt;!-- Do Nothing --&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;/xsl:template&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;xsl:template</span> <span style="color:#a6e22e">match=</span><span style="color:#e6db74">&#34;document&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;subjects&gt;</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">&lt;xsl:apply-templates</span> <span style="color:#a6e22e">select=</span><span style="color:#e6db74">&#34;table/row[@rownum &gt; 1]&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;/subjects&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;/xsl:template&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;xsl:template</span> <span style="color:#a6e22e">match=</span><span style="color:#e6db74">&#34;row&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;record&gt;</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">&lt;xsl:apply-templates</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;/record&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;/xsl:template&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;xsl:template</span> <span style="color:#a6e22e">match=</span><span style="color:#e6db74">&#34;cell&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;xsl:variable</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;cellnum&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">&lt;xsl:value-of</span> <span style="color:#a6e22e">select=</span><span style="color:#e6db74">&#34;@cellnum&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;/xsl:variable&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;xsl:variable</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;table&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">&lt;xsl:value-of</span> <span style="color:#a6e22e">select=</span><span style="color:#e6db74">&#34;ancestor::table/@name&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;/xsl:variable&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;xsl:variable</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;cellname&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">&lt;xsl:value-of</span> <span style="color:#a6e22e">select=</span><span style="color:#e6db74">&#34;/document/table[@name=$table]/row[@rownum=1]/cell[@cellnum=$cellnum]/p[1]&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;/xsl:variable&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;xsl:choose&gt;</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">&lt;xsl:when</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;string-length($cellname) &gt; 0&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;xsl:element</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;{$cellname}&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;xsl:apply-templates</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;/xsl:element&gt;</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">&lt;/xsl:when&gt;</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">&lt;xsl:otherwise&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;xsl:element</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;OOPS&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;xsl:apply-templates</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;/xsl:element&gt;</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">&lt;/xsl:otherwise&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;/xsl:choose&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;/xsl:template&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;xsl:template</span> <span style="color:#a6e22e">match=</span><span style="color:#e6db74">&#34;p&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;xsl:value-of</span> <span style="color:#a6e22e">select=</span><span style="color:#e6db74">&#34;.&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&lt;/xsl:template&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/xsl:stylesheet&gt;</span>
</span></span></code></pre></div><p>I hope someone finds that helpful.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://www.teale.de/tags/xslt/">xslt</a></li>
      <li><a href="https://www.teale.de/tags/open_office/">open_office</a></li>
      <li><a href="https://www.teale.de/tags/libre_office/">libre_office</a></li>
      <li><a href="https://www.teale.de/tags/fods/">fods</a></li>
      <li><a href="https://www.teale.de/tags/xml/">xml</a></li>
      <li><a href="https://www.teale.de/tags/spreadsheet/">spreadsheet</a></li>
      <li><a href="https://www.teale.de/tags/excel/">excel</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://www.teale.de/">Also sprach tealeg...</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
